



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Guice integration for OrientDB">
      
      
        <link rel="canonical" href="https://xvik.github.io/guice-persist-orient/3.3.2/getting-started/">
      
      
        <meta name="author" content="Vyacheslav Rusakov">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Getting started - Guice-persist-orient</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#getting-started" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://xvik.github.io/guice-persist-orient/3.3.2" title="Guice-persist-orient" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Guice-persist-orient
              </span>
              <span class="md-header-nav__topic">
                Getting started
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="http://github.com/xvik/guice-persist-orient/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      guice-persist-orient
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://xvik.github.io/guice-persist-orient/3.3.2" title="Guice-persist-orient" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Guice-persist-orient
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="http://github.com/xvik/guice-persist-orient/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      guice-persist-orient
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Getting started
      </label>
    
    <a href="./" title="Getting started" class="md-nav__link md-nav__link--active">
      Getting started
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-guice-module" title="Install guice module" class="md-nav__link">
    Install guice module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lifecycle" title="Lifecycle" class="md-nav__link">
    Lifecycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connections" title="Connections" class="md-nav__link">
    Connections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transactions" title="Transactions" class="md-nav__link">
    Transactions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema-initialization" title="Schema initialization" class="md-nav__link">
    Schema initialization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#object-scheme-mapping" title="Object scheme mapping" class="md-nav__link">
    Object scheme mapping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-initialization" title="Data initialization" class="md-nav__link">
    Data initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repositories" title="Repositories" class="md-nav__link">
    Repositories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      User guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../guide/configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../guide/connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../guide/transactions/" title="Transactions" class="md-nav__link">
      Transactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../guide/cache/" title="Cache" class="md-nav__link">
      Cache
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Object scheme mapping
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Object scheme mapping
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/objectscheme/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/writing/" title="Writing custom annotations" class="md-nav__link">
      Writing custom annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      Class
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        Class
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/compositeindex/" title="@CompositeIndex" class="md-nav__link">
      @CompositeIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/compositeluceneindex/" title="@CompositeLuceneIndex" class="md-nav__link">
      @CompositeLuceneIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/dropindexes/" title="@DropIndexes" class="md-nav__link">
      @DropIndexes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/edge/" title="@EdgeType" class="md-nav__link">
      @EdgeType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/rename/" title="@RenameFrom" class="md-nav__link">
      @RenameFrom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/recreate/" title="@Recreate" class="md-nav__link">
      @Recreate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/class/vertex/" title="@VertexType" class="md-nav__link">
      @VertexType
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      Property
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        Property
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/caseinsensitive/" title="@CaseInsensitive" class="md-nav__link">
      @CaseInsensitive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/fulltextindex/" title="@FulltextIndex" class="md-nav__link">
      @FulltextIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/" title="@Index" class="md-nav__link">
      @Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/mandatory/" title="@Mandatory" class="md-nav__link">
      @Mandatory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/luceneindex/" title="@LuceneIndex" class="md-nav__link">
      @LuceneIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/notnull/" title="@ONotNull" class="md-nav__link">
      @ONotNull
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/readonly/" title="@Readonly" class="md-nav__link">
      @Readonly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mapping/property/renameproperty/" title="@RenameFromProperty" class="md-nav__link">
      @RenameFromProperty
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Repository
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Repository
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/commandmethods/" title="Command methods" class="md-nav__link">
      Command methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/delegatemethods/" title="Delegate methods" class="md-nav__link">
      Delegate methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixins/" title="Mixins" class="md-nav__link">
      Mixins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/result/" title="Result conversion" class="md-nav__link">
      Result conversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/internals/" title="Implementation details" class="md-nav__link">
      Implementation details
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/commandinternals/" title="Command implementation" class="md-nav__link">
      Command implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/delegateinternals/" title="Delegate implementation" class="md-nav__link">
      Delegate implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9" type="checkbox" id="nav-6-9">
    
    <label class="md-nav__link" for="nav-6-9">
      Command
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-9">
        Command
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/asyncquery/" title="@AsyncQuery" class="md-nav__link">
      @AsyncQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/function/" title="@Function" class="md-nav__link">
      @Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/livequery/" title="@LiveQuery" class="md-nav__link">
      @LiveQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/query/" title="@Query" class="md-nav__link">
      @Query
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/script/" title="@Script" class="md-nav__link">
      @Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9-6" type="checkbox" id="nav-6-9-6">
    
    <label class="md-nav__link" for="nav-6-9-6">
      Params
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-6">
        Params
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/dynamic/" title="@DynamicParams" class="md-nav__link">
      @DynamicParams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/elvar/" title="@ElVar" class="md-nav__link">
      @ElVar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/fetchplan/" title="@FetchPlan" class="md-nav__link">
      @FetchPlan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/listen/" title="@Listen" class="md-nav__link">
      @Listen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/param/" title="@Param" class="md-nav__link">
      @Param
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/ridelvar/" title="@RidElVar" class="md-nav__link">
      @RidElVar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/pagination/" title="@Skip & @Limit" class="md-nav__link">
      @Skip & @Limit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/param/var/" title="@Var" class="md-nav__link">
      @Var
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9-7" type="checkbox" id="nav-6-9-7">
    
    <label class="md-nav__link" for="nav-6-9-7">
      Amend
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-7">
        Amend
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/command/amend/timeout/" title="@Timeout" class="md-nav__link">
      @Timeout
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-10" type="checkbox" id="nav-6-10">
    
    <label class="md-nav__link" for="nav-6-10">
      Delegate
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-10">
        Delegate
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/delegate/delegate/" title="@Delegate" class="md-nav__link">
      @Delegate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-10-2" type="checkbox" id="nav-6-10-2">
    
    <label class="md-nav__link" for="nav-6-10-2">
      Params
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-10-2">
        Params
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/delegate/param/connection/" title="@Connection" class="md-nav__link">
      @Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/delegate/param/generic/" title="@Generic" class="md-nav__link">
      @Generic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/delegate/param/repository/" title="@Repository" class="md-nav__link">
      @Repository
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-11" type="checkbox" id="nav-6-11">
    
    <label class="md-nav__link" for="nav-6-11">
      Result
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-11">
        Result
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/result/noconvert/" title="@NoConversion" class="md-nav__link">
      @NoConversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/result/detach/" title="@DetachResult" class="md-nav__link">
      @DetachResult
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-12" type="checkbox" id="nav-6-12">
    
    <label class="md-nav__link" for="nav-6-12">
      Mixin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-12">
        Mixin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixin/doccrud/" title="DocumentCrud" class="md-nav__link">
      DocumentCrud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixin/objcrud/" title="ObjectCrud" class="md-nav__link">
      ObjectCrud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixin/objvcrud/" title="ObjectVertexCrud" class="md-nav__link">
      ObjectVertexCrud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixin/edges/" title="EdgesSupport" class="md-nav__link">
      EdgesSupport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixin/edgetype/" title="EdgeTypeSupport" class="md-nav__link">
      EdgeTypeSupport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository/mixin/pagination/" title="Pagination" class="md-nav__link">
      Pagination
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../about/compatibility/" title="Compatibility" class="md-nav__link">
      Compatibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/history/" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-guice-module" title="Install guice module" class="md-nav__link">
    Install guice module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lifecycle" title="Lifecycle" class="md-nav__link">
    Lifecycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connections" title="Connections" class="md-nav__link">
    Connections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transactions" title="Transactions" class="md-nav__link">
    Transactions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema-initialization" title="Schema initialization" class="md-nav__link">
    Schema initialization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#object-scheme-mapping" title="Object scheme mapping" class="md-nav__link">
    Object scheme mapping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-initialization" title="Data initialization" class="md-nav__link">
    Data initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repositories" title="Repositories" class="md-nav__link">
    Repositories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="http://github.com/xvik/guice-persist-orient/edit/master/src/doc/docs/getting-started.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h1>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>Available from <a href="https://maven-badges.herokuapp.com/maven-central/ru.vyarus/guice-persist-orient">maven central</a> and <a href="https://bintray.com/vyarus/xvik/guice-persist-orient/_latestVersion">bintray jcenter</a></p>
<p>Maven:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
<span class="nt">&lt;groupId&gt;</span>ru.vyarus<span class="nt">&lt;/groupId&gt;</span>
<span class="nt">&lt;artifactId&gt;</span>guice-persist-orient<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;version&gt;</span>3.3.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;exclusions&gt;</span>
  <span class="nt">&lt;exclusion&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>com.orientechnologies<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>orientdb-graphdb<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/exclusion&gt;</span>
  <span class="nt">&lt;exclusion&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>com.orientechnologies<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>orientdb-object<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/exclusion&gt;</span>
<span class="nt">&lt;/exclusions&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<p>Gradle:</p>
<div class="codehilite"><pre><span></span><span class="n">compile</span> <span class="o">(</span><span class="s1">&#39;ru.vyarus:guice-persist-orient:3.3.2&#39;</span><span class="o">){</span>
    <span class="n">exclude</span> <span class="nl">module:</span> <span class="s1">&#39;orientdb-graphdb&#39;</span>
    <span class="n">exclude</span> <span class="nl">module:</span> <span class="s1">&#39;orientdb-object&#39;</span>       
<span class="o">}</span>
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remove exclusions to enable object and graph db support.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It's very important for object db to use exact <code>javassist</code> version it depends on. If other libraries in 
your classpath use <code>javassist</code>, check that newer or older version not appear in classpath.</p>
</div>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<h3 id="install-guice-module">Install guice module<a class="headerlink" href="#install-guice-module" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">install</span><span class="o">(</span><span class="k">new</span> <span class="n">OrientModule</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">user</span><span class="o">,</span> <span class="n">password</span><span class="o">));</span>
</pre></div>

<p>See <a href="http://orientdb.com/docs/last/Concepts.html#database-url">orient documentation</a> for supported db types.
In short:</p>
<ul>
<li><code>memory:dbname</code> to use in-memory database</li>
<li><code>plocal:dbname</code> to use embedded database (no server required, local fs folder will be used); db name must be local fs path</li>
<li><code>remote:dbname</code> to use remote db (you need to start server to use it)</li>
</ul>
<p>By default use <code>admin/admin</code> user.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Auto database creation for local types (all except 'remote') is enabled by default, but you 
<a href="../guide/configuration/#auto-database-creation">can switch it off</a>.     </p>
</div>
<h3 id="lifecycle">Lifecycle<a class="headerlink" href="#lifecycle" title="Permanent link">&para;</a></h3>
<p>You need to manually start/stop persist service in your code (because only you can control application lifecycle).
On start connection pools will be initialized, database created (if required) and scheme/data initializers called. Stop will shutdown
all connection pools.</p>
<div class="codehilite"><pre><span></span><span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyLifecycle</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="kd">private</span> <span class="n">PersistService</span> <span class="n">orientService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(){</span>
        <span class="n">orientService</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">(){</span>
        <span class="n">orientService</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>Assuming start and stop methods are called on application startup/shutdown. </p>
<h3 id="connections">Connections<a class="headerlink" href="#connections" title="Permanent link">&para;</a></h3>
<p><a href="http://orientdb.com/docs/2.2.x/Document-Database.html">Document</a> is the core connection type. 
<a href="http://orientdb.com/docs/2.2.x/Object-Database.html">Object</a> and <a href="http://orientdb.com/docs/2.2.x/Graph-Database-Tinkerpop.html">graph</a> 
apis use document connection internally.
Connection object mainly defines the result of queries: </p>
<ul>
<li>document connection will always return ODocument</li>
<li>object connection returns mapped pojos (actually proxies) or ODocument for fields selections and</li>
<li>graph api returns Vertex and Edge types.</li>
</ul>
<p>And of course connections provide specific apis for types.</p>
<p>You can use any connections within single transaction and changes made in one connection type will be visible
in other connections. This allows you, for example to update data using object api and create relations using graph api.</p>
<p>To access connection object inside transaction use <code>PersistentContext</code> generified with the type of required connection.</p>
<ul>
<li><code>PersistentContext&lt;OObjectDatabaseTx&gt;</code> for object database connection</li>
<li><code>PersistentContext&lt;ODatabaseDocumentTx&gt;</code> for document database connection</li>
<li><code>PersistentContext&lt;OrientBaseGraph&gt;</code> for graph database connection (transactional or not)</li>
<li><code>PersistentContext&lt;OrientGraph&gt;</code> for transactional graph database connection (will fail if notx transaction type)</li>
<li><code>PersistentContext&lt;OrientGraphNoTx&gt;</code> for non transactional graph database connection (will provide only for notx transaction type, otherwise fail)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>you can't use both OrientGraph and OrientGraphNoTx in the same transaction (type must be used according to transaction type).
OrientBaseGraph may be used in places where both types are possible (its the base class for both).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>PersistentContext</code> methods are shortcuts for low level api (simplifies usage). You can extend it to add more shortcut methods
or make your own: it is not used internally and exists only for public usage.</p>
</div>
<p>For example</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyService</span> <span class="o">{</span>

    <span class="nd">@Inject</span>    
    <span class="kd">private</span> <span class="n">PersistenceContext</span><span class="o">&lt;</span><span class="n">OObjectDatabaseTx</span><span class="o">&gt;</span> <span class="n">context</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Model</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// manual transaction declaration</span>
        <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="na">doInTransaction</span><span class="o">((</span><span class="n">db</span><span class="o">)</span> <span class="o">-&gt;</span> 
            <span class="c1">// pure orient api</span>
            <span class="n">db</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="k">new</span> <span class="n">OSQLSynchQuery</span><span class="o">&lt;</span><span class="n">Model</span><span class="o">&gt;(</span><span class="s">&quot;select from Model where name=?&quot;</span><span class="o">),</span> <span class="n">name</span><span class="o">)</span>
        <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>Alternatively, you can directly inject connections:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Inject</span>
<span class="kd">private</span> <span class="n">Provider</span><span class="o">&lt;</span><span class="n">OObjectDatabaseTx</span><span class="o">&gt;</span> <span class="n">db</span><span class="o">;</span>
</pre></div>

<p>But note that it would not work without external transaction.</p>
<h3 id="transactions">Transactions<a class="headerlink" href="#transactions" title="Permanent link">&para;</a></h3>
<p>There are 3 ways to declare <a href="http://orientdb.com/docs/last/Transactions.html">transaction</a>:</p>
<ul>
<li><code>@Transactional</code> annotation on guice bean or single method (additional <code>@TxType</code> annotation allows to define different transaction type for specific unit of work)</li>
<li>Inject <code>PersistentContext</code> bean into your service and use its methods</li>
<li>Using <code>TransactionManager</code> begin() and end() methods (low level trasaction control).</li>
</ul>
<p>First two options are better, because they automatically manage rollbacks and avoid not closed (forgot to call end) transactions.</p>
<p>For example, to declare transaction using annotation:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyService</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>

<p>Or</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyService</span> <span class="o">{</span>
    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Private methods can't be annotated with <code>@Transactional</code>: method must be at least package-private.</p>
</div>
<p>Transaction scopes could intersect: e.g. if transactional method calls bean, also annotated as transactional,
then only root transaction scope will work (no sub-transaction or anything like this).  </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you need to execute without transaction, you still need to declare it
<div class="codehilite"><pre><span></span><span class="nd">@Transactional</span>
<span class="nd">@TxType</span><span class="o">(</span><span class="n">OTransaction</span><span class="o">.</span><span class="na">TXTYPE</span><span class="o">.</span><span class="na">NOTX</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="o">()</span>
</pre></div>
This is required, for example, for schema updates</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>in contrast to spring default proxies, in guice when you call bean method inside the same bean, annotation interceptor will still work.
So it's possible to define few units of work withing single bean using annotations:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">nonTxMethod</span><span class="o">(){</span>
    <span class="n">doTx1</span><span class="o">();</span>
    <span class="n">doTx2</span><span class="o">();</span>
<span class="o">}</span>

<span class="nd">@Transactional</span>
<span class="kt">void</span> <span class="nf">doTx1</span><span class="o">()</span> <span class="o">{..}</span>

<span class="nd">@Transactional</span>
<span class="kt">void</span> <span class="nf">doTx2</span><span class="o">()</span> <span class="o">{..}</span>
</pre></div>

</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you get error like  <br />
<div class="codehilite"><pre><span></span>Database instance is not set in current thread. Assure to set it with: ODatabaseRecordThreadLocal.instance().set(db)
</pre></div>
It almost certainly means that you perform transactional operation outside of transaction. Simply enlarge transaction scope.    </p>
<p>When you inside transaction, <code>activateOnCurrentThread()</code> is called each time you obtain connection from raw connection provider or PersistentContext
and you will always have correctly bound connection.    </p>
<p>For example, even document creation (<code>new ODocument()</code>) must be performed inside transaction.</p>
</div>
<h3 id="schema-initialization">Schema initialization<a class="headerlink" href="#schema-initialization" title="Permanent link">&para;</a></h3>
<p>In order to work with database, you obviously need to initialize it's schema first.</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MySchemeInitializer</span> <span class="kd">implements</span> <span class="n">SchemeInitializer</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="kd">private</span> <span class="n">Provider</span><span class="o">&lt;</span><span class="n">OObjectDatabaseTx</span><span class="o">&gt;</span> <span class="n">provider</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">final</span>  <span class="n">OObjectDatabaseTx</span> <span class="n">db</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">db</span><span class="o">.</span><span class="na">getMetadata</span><span class="o">().</span><span class="na">getSchema</span><span class="o">().</span><span class="na">existsClass</span><span class="o">(</span><span class="s">&quot;Account&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// schema already created - do nothing</span>
            <span class="k">return</span><span class="o">;</span>            
        <span class="o">}</span>

        <span class="n">OClass</span> <span class="n">account</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">getMetadata</span><span class="o">().</span><span class="na">getSchema</span><span class="o">().</span><span class="na">createClass</span><span class="o">(</span><span class="s">&quot;Account&quot;</span><span class="o">);</span>
        <span class="n">account</span><span class="o">.</span><span class="na">createProperty</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">OType</span><span class="o">.</span><span class="na">Integer</span><span class="o">);</span>
        <span class="n">account</span><span class="o">.</span><span class="na">createProperty</span><span class="o">(</span><span class="s">&quot;birthDate&quot;</span><span class="o">,</span> <span class="n">OType</span><span class="o">.</span><span class="na">Date</span><span class="o">);</span>

        <span class="c1">//or using sql statements</span>
        <span class="n">db</span><span class="o">.</span><span class="na">command</span><span class="o">(</span><span class="k">new</span> <span class="n">OCommandSQL</span><span class="o">(</span><span class="s">&quot;CREATE CLASS Account&quot;</span><span class="o">)).</span><span class="na">execute</span><span class="o">();</span>         
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>To do it register implementation of <code>ru.vyarus.guice.persist.orient.db.scheme.SchemeInitializer</code> 
in guice module:</p>
<div class="codehilite"><pre><span></span><span class="n">bind</span><span class="o">(</span><span class="n">SchemeInitializer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">MySchemeInitializer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>

<p>Initializer is called without transaction (NOTX transaction type) as orient requires
database updates to be performed without transaction.</p>
<h4 id="object-scheme-mapping">Object scheme mapping<a class="headerlink" href="#object-scheme-mapping" title="Permanent link">&para;</a></h4>
<p>If you are using object api, then you can create schema directly from your model objects.
In this case you dont need to implement your own <code>SchemeInitializer</code>, instead register module:</p>
<div class="codehilite"><pre><span></span><span class="n">install</span><span class="o">(</span><span class="k">new</span> <span class="n">AutoScanSchemeModule</span><span class="o">(</span><span class="s">&quot;my.model.root.package&quot;</span><span class="o">));</span>
</pre></div>

<p>Module will find all classes, annotated with <code>@Persistent</code> using classpath scan and register them in orient.</p>
<p>For example:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Persistent</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Account</span> <span class="o">{</span>
        <span class="nd">@Id</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
        <span class="nd">@Version</span>
        <span class="kd">private</span> <span class="n">Long</span> <span class="n">version</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">myProp</span><span class="o">;</span>

        <span class="c1">// getters and setters        </span>
<span class="o">}</span>
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to use graph api with objects then annotate your class as <code>@VertexType</code> or <code>@EdgeType</code>
in order to correct create graph schema from object.</p>
</div>
<p>More about <a href="../mapping/objectscheme/">object scheme mapping</a>.</p>
<h3 id="data-initialization">Data initialization<a class="headerlink" href="#data-initialization" title="Permanent link">&para;</a></h3>
<p>You may need to initialize some sample data before start (e.g.for testing) or perform some
data updates. Implement <code>ru.vyarus.guice.persist.orient.db.data.DataInitializer</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyDataInitializer</span> <span class="kd">implements</span> <span class="n">DataInitializer</span> <span class="o">{</span>
    <span class="nd">@Inject</span>
    <span class="kd">private</span> <span class="n">Provider</span><span class="o">&lt;</span><span class="n">OObjectDatabaseTx</span><span class="o">&gt;</span> <span class="n">provider</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="nd">@Transactional</span>
    <span class="kt">void</span> <span class="nf">initializeData</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">final</span>  <span class="n">OObjectDatabaseTx</span> <span class="n">db</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="c1">// init only if database is empty</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">db</span><span class="o">.</span><span class="na">getMetadata</span><span class="o">().</span><span class="na">getSchema</span><span class="o">().</span><span class="na">getClass</span><span class="o">(</span><span class="n">Account</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">count</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">db</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="n">Account</span><span class="o">(</span><span class="s">&quot;something 1&quot;</span><span class="o">));</span>
            <span class="n">db</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="n">Account</span><span class="o">(</span><span class="s">&quot;something 2&quot;</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<h3 id="repositories">Repositories<a class="headerlink" href="#repositories" title="Permanent link">&para;</a></h3>
<p>You can also use interfaces for queries declaration (very like spring-data).</p>
<p>Register repositories module:</p>
<div class="codehilite"><pre><span></span><span class="n">install</span><span class="o">(</span><span class="k">new</span> <span class="n">RepositoryModule</span><span class="o">());</span>
</pre></div>

<p>Now you can declare:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Transactional</span>
<span class="nd">@ProvidedBy</span><span class="o">(</span><span class="n">DynamicSingletonProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AccountRepository</span> <span class="o">{</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;select from Account&quot;</span><span class="o">)</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span> <span class="nf">selectAll</span><span class="o">();</span> 

    <span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;update Account set name = ? where name = ?&quot;</span><span class="o">)</span>
    <span class="kt">int</span> <span class="nf">updateName</span><span class="o">(</span><span class="n">String</span> <span class="n">newName</span><span class="o">,</span> <span class="n">String</span> <span class="n">oldName</span><span class="o">);</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;insert into Account (name) values(:name)&quot;</span><span class="o">)</span>
    <span class="n">Account</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>

<p>Later this repository could be injected as normal guice bean:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Transactonal</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyService</span> <span class="o">{</span>
    <span class="nd">@Inject</span>
    <span class="kd">private</span> <span class="n">AccountRepository</span> <span class="n">repo</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span> <span class="n">all</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>Or you can use repository methods directly in other beans:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Transactional</span>
<span class="nd">@ProvidedBy</span><span class="o">(</span><span class="n">DynamicSingletonProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">MyDao</span> <span class="o">{</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;select from Account&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span> <span class="nf">selectAll</span><span class="o">();</span>

    <span class="c1">// normal method</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span> <span class="n">all</span> <span class="o">=</span> <span class="n">selectAll</span><span class="o">();</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>IDE could warn you about <code>@ProvidedBy(DynamicSingletonProvider.class)</code>, but it's the only way to avoid additional
(direct) registrations. If warning is annoying for you, you can register beans manually instead:
<div class="codehilite"><pre><span></span><span class="n">bind</span><span class="o">(</span><span class="n">AccountRepository</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">DynamicClassGenerator</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="n">MyInterfaceRepository</span><span class="o">.</span><span class="na">class</span><span class="o">)).</span><span class="na">in</span><span class="o">(</span><span class="n">Singleton</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</pre></div></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Guice aop will work on repositories (in fact it's implemented using aop), so you may
use any other aop-driven annotations there.    </p>
</div>
<p>More about <a href="../repository/overview/">repositories</a>    </p>
<h3 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h3>
<p>If you want to use orient with object mappings, then guice initialization will look like:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyModule</span> <span class="kd">extends</span> <span class="n">AbstractModule</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">install</span><span class="o">(</span><span class="k">new</span> <span class="n">OrientModule</span><span class="o">(</span><span class="s">&quot;memory:test&quot;</span><span class="o">,</span> <span class="s">&quot;admin&quot;</span><span class="o">,</span> <span class="s">&quot;admin&quot;</span><span class="o">));</span>
        <span class="n">install</span><span class="o">(</span><span class="k">new</span> <span class="n">AutoScanSchemeModule</span><span class="o">(</span><span class="s">&quot;my.model.root.package&quot;</span><span class="o">));</span>
        <span class="n">install</span><span class="o">(</span><span class="k">new</span> <span class="n">RepositoryModule</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>And you will need to start and shutdown persistence support:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Inject</span>
<span class="kd">private</span> <span class="n">PersistService</span> <span class="n">orientService</span><span class="o">;</span>

<span class="c1">// called manually</span>
<span class="n">orientService</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

<span class="o">...</span>

<span class="c1">// called manually before shutdown</span>
<span class="n">orientService</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../api/" title="API" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                API
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2014-2018 Vyacheslav Rusakov
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/xvik" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/vyarus" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>