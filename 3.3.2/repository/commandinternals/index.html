



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Guice integration for OrientDB">
      
      
        <link rel="canonical" href="https://xvik.github.io/guice-persist-orient/3.3.2/repository/commandinternals/">
      
      
        <meta name="author" content="Vyacheslav Rusakov">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Command implementation - Guice-persist-orient</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#command-methods-implementation-details" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://xvik.github.io/guice-persist-orient/3.3.2" title="Guice-persist-orient" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Guice-persist-orient
              </span>
              <span class="md-header-nav__topic">
                Command implementation
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="http://github.com/xvik/guice-persist-orient/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      guice-persist-orient
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://xvik.github.io/guice-persist-orient/3.3.2" title="Guice-persist-orient" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Guice-persist-orient
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="http://github.com/xvik/guice-persist-orient/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      guice-persist-orient
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      User guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/transactions/" title="Transactions" class="md-nav__link">
      Transactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cache/" title="Cache" class="md-nav__link">
      Cache
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Object scheme mapping
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Object scheme mapping
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/objectscheme/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/writing/" title="Writing custom annotations" class="md-nav__link">
      Writing custom annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      Class
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        Class
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/compositeindex/" title="@CompositeIndex" class="md-nav__link">
      @CompositeIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/compositeluceneindex/" title="@CompositeLuceneIndex" class="md-nav__link">
      @CompositeLuceneIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/dropindexes/" title="@DropIndexes" class="md-nav__link">
      @DropIndexes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/edge/" title="@EdgeType" class="md-nav__link">
      @EdgeType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/rename/" title="@RenameFrom" class="md-nav__link">
      @RenameFrom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/recreate/" title="@Recreate" class="md-nav__link">
      @Recreate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/class/vertex/" title="@VertexType" class="md-nav__link">
      @VertexType
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      Property
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        Property
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/caseinsensitive/" title="@CaseInsensitive" class="md-nav__link">
      @CaseInsensitive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/fulltextindex/" title="@FulltextIndex" class="md-nav__link">
      @FulltextIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/" title="@Index" class="md-nav__link">
      @Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/mandatory/" title="@Mandatory" class="md-nav__link">
      @Mandatory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/luceneindex/" title="@LuceneIndex" class="md-nav__link">
      @LuceneIndex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/notnull/" title="@ONotNull" class="md-nav__link">
      @ONotNull
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/readonly/" title="@Readonly" class="md-nav__link">
      @Readonly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mapping/property/renameproperty/" title="@RenameFromProperty" class="md-nav__link">
      @RenameFromProperty
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Repository
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Repository
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commandmethods/" title="Command methods" class="md-nav__link">
      Command methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../delegatemethods/" title="Delegate methods" class="md-nav__link">
      Delegate methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mixins/" title="Mixins" class="md-nav__link">
      Mixins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../result/" title="Result conversion" class="md-nav__link">
      Result conversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internals/" title="Implementation details" class="md-nav__link">
      Implementation details
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Command implementation
      </label>
    
    <a href="./" title="Command implementation" class="md-nav__link md-nav__link--active">
      Command implementation
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-command-features" title="Common command features" class="md-nav__link">
    Common command features
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sqlcommanddescriptor-phase" title="SqlCommandDescriptor phase" class="md-nav__link">
    SqlCommandDescriptor phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocommandrequest-phase" title="OCommandRequest phase" class="md-nav__link">
    OCommandRequest phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extensions-lifecycle" title="Extensions lifecycle" class="md-nav__link">
    Extensions lifecycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-parameters-context" title="Command parameters context" class="md-nav__link">
    Command parameters context
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-command-parameter-extension" title="Implementing command parameter extension" class="md-nav__link">
    Implementing command parameter extension
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-command-method-amend-extension" title="Implementing command method amend extension" class="md-nav__link">
    Implementing command method amend extension
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../delegateinternals/" title="Delegate implementation" class="md-nav__link">
      Delegate implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9" type="checkbox" id="nav-6-9">
    
    <label class="md-nav__link" for="nav-6-9">
      Command
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-9">
        Command
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../command/asyncquery/" title="@AsyncQuery" class="md-nav__link">
      @AsyncQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/function/" title="@Function" class="md-nav__link">
      @Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/livequery/" title="@LiveQuery" class="md-nav__link">
      @LiveQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/query/" title="@Query" class="md-nav__link">
      @Query
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/script/" title="@Script" class="md-nav__link">
      @Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9-6" type="checkbox" id="nav-6-9-6">
    
    <label class="md-nav__link" for="nav-6-9-6">
      Params
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-6">
        Params
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/dynamic/" title="@DynamicParams" class="md-nav__link">
      @DynamicParams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/elvar/" title="@ElVar" class="md-nav__link">
      @ElVar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/fetchplan/" title="@FetchPlan" class="md-nav__link">
      @FetchPlan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/listen/" title="@Listen" class="md-nav__link">
      @Listen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/param/" title="@Param" class="md-nav__link">
      @Param
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/ridelvar/" title="@RidElVar" class="md-nav__link">
      @RidElVar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/pagination/" title="@Skip & @Limit" class="md-nav__link">
      @Skip & @Limit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command/param/var/" title="@Var" class="md-nav__link">
      @Var
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9-7" type="checkbox" id="nav-6-9-7">
    
    <label class="md-nav__link" for="nav-6-9-7">
      Amend
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-7">
        Amend
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../command/amend/timeout/" title="@Timeout" class="md-nav__link">
      @Timeout
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-10" type="checkbox" id="nav-6-10">
    
    <label class="md-nav__link" for="nav-6-10">
      Delegate
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-10">
        Delegate
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../delegate/delegate/" title="@Delegate" class="md-nav__link">
      @Delegate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-10-2" type="checkbox" id="nav-6-10-2">
    
    <label class="md-nav__link" for="nav-6-10-2">
      Params
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-10-2">
        Params
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../delegate/param/connection/" title="@Connection" class="md-nav__link">
      @Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../delegate/param/generic/" title="@Generic" class="md-nav__link">
      @Generic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../delegate/param/repository/" title="@Repository" class="md-nav__link">
      @Repository
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-11" type="checkbox" id="nav-6-11">
    
    <label class="md-nav__link" for="nav-6-11">
      Result
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-11">
        Result
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../result/noconvert/" title="@NoConversion" class="md-nav__link">
      @NoConversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../result/detach/" title="@DetachResult" class="md-nav__link">
      @DetachResult
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-12" type="checkbox" id="nav-6-12">
    
    <label class="md-nav__link" for="nav-6-12">
      Mixin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-12">
        Mixin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../mixin/doccrud/" title="DocumentCrud" class="md-nav__link">
      DocumentCrud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mixin/objcrud/" title="ObjectCrud" class="md-nav__link">
      ObjectCrud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mixin/objvcrud/" title="ObjectVertexCrud" class="md-nav__link">
      ObjectVertexCrud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mixin/edges/" title="EdgesSupport" class="md-nav__link">
      EdgesSupport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mixin/edgetype/" title="EdgeTypeSupport" class="md-nav__link">
      EdgeTypeSupport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mixin/pagination/" title="Pagination" class="md-nav__link">
      Pagination
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/compatibility/" title="Compatibility" class="md-nav__link">
      Compatibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-command-features" title="Common command features" class="md-nav__link">
    Common command features
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sqlcommanddescriptor-phase" title="SqlCommandDescriptor phase" class="md-nav__link">
    SqlCommandDescriptor phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocommandrequest-phase" title="OCommandRequest phase" class="md-nav__link">
    OCommandRequest phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extensions-lifecycle" title="Extensions lifecycle" class="md-nav__link">
    Extensions lifecycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-parameters-context" title="Command parameters context" class="md-nav__link">
    Command parameters context
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-command-parameter-extension" title="Implementing command parameter extension" class="md-nav__link">
    Implementing command parameter extension
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-command-method-amend-extension" title="Implementing command method amend extension" class="md-nav__link">
    Implementing command method amend extension
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="http://github.com/xvik/guice-persist-orient/edit/master/src/doc/docs/repository/commandinternals.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="command-methods-implementation-details">Command methods implementation details<a class="headerlink" href="#command-methods-implementation-details" title="Permanent link">&para;</a></h1>
<p>Command method extensions applied to all command extensions (<code>@Query</code>, <code>@Function</code>, <code>@Script</code> etc.)</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Read <a href="../internals/">repository internals</a> first for better understanding</p>
</div>
<h2 id="common-command-features">Common command features<a class="headerlink" href="#common-command-features" title="Permanent link">&para;</a></h2>
<p>Commands generally support:</p>
<ul>
<li>Positional parameters</li>
<li>Named parameters</li>
<li>Command string el variables</li>
</ul>
<p>Most commands use <code>CommandMethodDescriptor</code> as descriptor, except <code>@Script</code> which use <code>ScriptCommandMethodDescriptor</code> (to store script language). So when you target <code>CommandMethodDescriptor</code> (in generic), extension will be compatible with all command methods.</p>
<p>All command extensions use <code>AbstractCommandExtension</code> as base class. It's very easy to add your own custom command annotation using it (look bundled extensions sources).</p>
<p>Command extensions have three execution phases:</p>
<ul>
<li><code>SqlCommandDescriptor</code> composition</li>
<li><code>OCommandRequest</code> composition (orient command)</li>
<li>And command execution </li>
</ul>
<p>Amend extension shoudl implement <code>CommandExtension</code> insterface (to affect execution).</p>
<h3 id="sqlcommanddescriptor-phase">SqlCommandDescriptor phase<a class="headerlink" href="#sqlcommanddescriptor-phase" title="Permanent link">&para;</a></h3>
<p><code>SqlCommandDescriptor</code> contains query, prepared parameters (composed from method arguments) and el variables (also composed fro arguments). Extensions could modify query (for example, @Skip appends "SKIP" part to query string. Extensions could add (or modify) query parameters. And extensions could add/modify el variables.</p>
<p>Positional parameters is a core feature (its parameters without any extension), anyway they could be modified too (for example, <code>@DynamicParams</code> modifies them).</p>
<p>Named parameters covered with bundled extension <code>@Param</code>. It is not mandatory to use it: you can write your own extension to define named parameters.</p>
<p>El variables defined with <code>@ElVar</code> extension, but again, its not mandatory - you can use your own extension to define variables.</p>
<h3 id="ocommandrequest-phase">OCommandRequest phase<a class="headerlink" href="#ocommandrequest-phase" title="Permanent link">&para;</a></h3>
<p>First of all, el variables replaced in query, producing target query string.
Then command object created using prepared query.</p>
<p>Extensions could modify resulted command object (for example, <code>@Timaout</code>, <code>@Listen</code>).</p>
<p>After all command object wrapped with connection object (using selected RepositoryExecutor) and executed, using composed parameters.
Command wrapping is required to bind command to specific connection type. This will affect resulting objects.</p>
<h3 id="extensions-lifecycle">Extensions lifecycle<a class="headerlink" href="#extensions-lifecycle" title="Permanent link">&para;</a></h3>
<ul>
<li>Create <code>SqlCommandDescriptor</code></li>
<li>Run extensions to amend descriptor</li>
<li>Apply el vars and create <code>OCommandRequest</code></li>
<li>Run extensions to amend request object</li>
<li>Wrap command with connection and execute with prepared parameters</li>
</ul>
<h3 id="command-parameters-context">Command parameters context<a class="headerlink" href="#command-parameters-context" title="Permanent link">&para;</a></h3>
<p>Command extensions use <code>CommandParamsContext</code> during parameters processing.</p>
<p>Parameter extensions are called after all parameters processing (to collect all parameters, marked with the same annotation)</p>
<p>If you need to modify positional parameters, you can obtain them through <code>paramsContext.getOrdinals()</code>. Usually, there is no need to modify them, because if you need special parameter handling you'll define custom annotation.</p>
<p>If your extension defines named parameter you may register it in context: <code>paramsContext.addNamedParam()</code>.
After registration, it will be applied automatically. 
You may omit registration if your parameter must be converted or something like this (in this case you'll use amend extension to manually apply parameter value).</p>
<p>If your extension handles el variable you must declare it either as static <code>paramsContext.addStaticElVarValue()</code> if value is the same for all method executions, or declare it as dynamic <code>paramsContext.addDynamicElVarValue()</code>.
In case of dynamic el var, you'll need to use amend extension to manually apply value during execution.</p>
<p>Registration of el variables is required, because they are strictly checked and if some not declared variable found in query or declared variable not used in query error will be thrown to indicate method definition error. </p>
<p>If you need access to method, type, know root repository type or use generics info, use <code>paramsContext.getDescriptorContext()</code>. 
Note that if parameter type is generified, you will receive resolved generic in extension.</p>
<h2 id="implementing-command-parameter-extension">Implementing command parameter extension<a class="headerlink" href="#implementing-command-parameter-extension" title="Permanent link">&para;</a></h2>
<p>Suppose you want to implement <code>@MyCustomParam</code> parameter extension.</p>
<p>Declaring annotation:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Target</span><span class="o">(</span><span class="n">PARAMETER</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="nd">@MethodParam</span><span class="o">(</span><span class="n">MyCustomParamExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">MyCustomParam</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</pre></div>

<p>If required, define extension options as annotation attributes. <code>@MethodParam</code> marks extension as parameter extension and it will be found and <code>MyCustomParamExtension</code> class obtained from guice context and executed.</p>
<p>Now implement extension:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCustomParamExtension</span> <span class="kd">implements</span> 
        <span class="n">MethodParamExtension</span><span class="o">&lt;</span><span class="n">CommandMethodDescriptor</span><span class="o">,</span> <span class="n">CommandParamsContext</span><span class="o">,</span> <span class="n">MyCustomParam</span> <span class="o">&gt;{</span> 

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">processParameters</span><span class="o">(</span><span class="kd">final</span> <span class="n">CommandMethodDescriptor</span> <span class="n">descriptor</span><span class="o">,</span> <span class="kd">final</span> <span class="n">CommandParamsContext</span> <span class="n">context</span><span class="o">,</span>
                                  <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ParamInfo</span><span class="o">&lt;</span><span class="n">MyCustomParam</span><span class="o">&gt;&gt;</span> <span class="n">paramsInfo</span><span class="o">)</span> <span class="o">{</span>
       <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>This extension will be called once, during descriptor creation. Here you can validate parameters and, for example, register named parameter or el variable in paramsContext </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We declare <code>MethodParamExtension&lt;CommandMethodDescriptor ...&gt;</code>, this means extension is compatible only with command descriptor and can't be used with delegate (or some other) method extensions. Also, because <code>@Script</code>'s <code>ScriptCommandMethodDescriptor</code> extends CommandMethodDescriptor, this extension is compatible with scripts too.</p>
</div>
<p>If you need some execution time modification, you'll need to implement amend extension interface:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCustomParamExtension</span> <span class="kd">implements</span> 
        <span class="n">MethodParamExtension</span><span class="o">&lt;</span><span class="n">CommandMethodDescriptor</span><span class="o">,</span> <span class="n">CommandParamsContext</span><span class="o">,</span> <span class="n">MyCustomParam</span><span class="o">&gt;,</span>
        <span class="n">CommandExtension</span><span class="o">&lt;</span><span class="n">CommandMethodDescriptor</span><span class="o">&gt;</span> <span class="o">{</span> 

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">KEY</span> <span class="o">=</span> <span class="n">MyCustomParamExtension</span> <span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>

    <span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">amendCommandDescriptor</span><span class="o">(</span><span class="kd">final</span> <span class="n">SqlCommandDescriptor</span> <span class="n">sql</span><span class="o">,</span> <span class="kd">final</span> <span class="n">CommandMethodDescriptor</span> <span class="n">descriptor</span><span class="o">,</span>
                                       <span class="kd">final</span> <span class="n">Object</span> <span class="n">instance</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Object</span><span class="o">...</span> <span class="n">arguments</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">amendCommand</span><span class="o">(</span><span class="kd">final</span> <span class="n">OCommandRequest</span> <span class="n">query</span><span class="o">,</span> <span class="kd">final</span> <span class="n">CommandMethodDescriptor</span> <span class="n">descriptor</span><span class="o">,</span>
                             <span class="kd">final</span> <span class="n">Object</span> <span class="n">instance</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Object</span><span class="o">...</span> <span class="n">arguments</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
</pre></div>

<p>By implementing <code>CommandExtension</code> we did our extension compatible with command methods amend extension. Now parameter extension will be registered as amend extension afeter parameters processing.</p>
<p>Most likely you'll need some information from parameters processing method inside executino methods.
If it's not a simple value (int, string etc), define your value object <code>MyCustomParamDescriptor</code>.
Compose descriptor on processing phase and store inside main method descriptor:</p>
<div class="codehilite"><pre><span></span><span class="n">descriptor</span><span class="o">.</span><span class="na">extDescriptors</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">KEY</span><span class="o">,</span> <span class="n">yourCustomDescriptor</span><span class="o">);</span>
</pre></div>

<p>Now in execution method you can obtain it and use:</p>
<div class="codehilite"><pre><span></span><span class="n">MyCustomParamDescriptor</span> <span class="n">desc</span> <span class="o">=</span> <span class="o">(</span><span class="n">MyCustomParamDescriptor</span><span class="o">)</span> <span class="n">descriptor</span><span class="o">.</span><span class="na">extDescriptors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">KEY</span><span class="o">);</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>KEY is public. This will allow you to use it in unit tests and possibly, other extensions also could use it (for example, <code>@AsyncQuery</code> must know about <code>@Listen</code> extension).</p>
</div>
<p>That's all, extension could be used in command method:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;select from Model&quot;</span><span class="o">)</span>
<span class="n">List</span> <span class="nf">select</span><span class="o">(</span><span class="nd">@MyCustomParam</span> <span class="n">String</span> <span class="n">param</span><span class="o">);</span>
</pre></div>

<p>Look bundled extensions sources for advanced examples.</p>
<h2 id="implementing-command-method-amend-extension">Implementing command method amend extension<a class="headerlink" href="#implementing-command-method-amend-extension" title="Permanent link">&para;</a></h2>
<p>First of all, you can register custom amend extension globally:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Inject</span> <span class="n">AmendExtensionsService</span> <span class="n">amendExtensions</span><span class="o">;</span>
<span class="o">...</span>
<span class="n">amendExtensions</span><span class="o">.</span><span class="na">addGlobalExtension</span><span class="o">(</span><span class="k">new</span> <span class="n">CommandExtension</span><span class="o">()</span> <span class="o">{...});</span>
</pre></div>

<p>Or you can use custom annotation, for example:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Target</span><span class="o">({</span><span class="n">METHOD</span><span class="o">,</span> <span class="n">TYPE</span><span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="nd">@AmendMethod</span><span class="o">(</span><span class="n">MyCustomAmendExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">MyCustomAmend</span><span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</pre></div>

<p>Amend extensions are searched on method, on type and on root repository type. 
You can limit usage scope with <code>@Target</code> annotation (e.g. allow usage only on methods).
<code>@AmendMethod</code> marks annotation as amend annotation, now it will be resolved.</p>
<p>As with parameters, you eaither implement just parsing interface, to apply extension in descriptor creation time, or implement also amend extension interface, to use extension during method call.</p>
<div class="codehilite"><pre><span></span><span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCustomAmendExtension</span> <span class="kd">implements</span> 
        <span class="n">AmendMethodExtension</span><span class="o">&lt;</span><span class="n">CommandMethodDescriptor</span><span class="o">,</span> <span class="n">MyCustomAmend</span><span class="o">&gt;,</span>
        <span class="n">CommandExtension</span><span class="o">&lt;</span><span class="n">CommandMethodDescriptor</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleAnnotation</span><span class="o">(</span><span class="kd">final</span> <span class="n">CommandMethodDescriptor</span> <span class="n">descriptor</span><span class="o">,</span> <span class="kd">final</span> <span class="n">MyCustomAmend</span> <span class="n">annotation</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>

    <span class="o">...</span>
<span class="o">}</span>
</pre></div>

<p>Implementation guideline is the same as with params: use public KEY field and custom descriptor object.</p>
<p>Extension could be used like this:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;select from Model&quot;</span><span class="o">)</span>
<span class="nd">@MyCustomAmend</span>
<span class="n">List</span> <span class="nf">select</span><span class="o">();</span>
</pre></div>

<p>See <a href="../command/amend/timeout/">@Timeout</a> as implementation example.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../internals/" title="Implementation details" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Implementation details
              </span>
            </div>
          </a>
        
        
          <a href="../delegateinternals/" title="Delegate implementation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Delegate implementation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2014-2018 Vyacheslav Rusakov
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/xvik" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/vyarus" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>